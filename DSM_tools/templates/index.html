<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../static/css/style.css">
    <title>JWT ì¸ì½”ë” & ë””ì½”ë”</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>
<body>
    <h2>JWT Encode & Decode</h2>

    <h3 style="margin-top: 3%;">ğŸ” JWT Decode</h3>
    <form method="POST">
        <textarea name="jwt_token" placeholder="ì—¬ê¸°ì— JWTë¥¼ ì…ë ¥í•˜ì„¸ìš”" style="font-size: 16px;"></textarea>
        <br>
        <input type="text" name="secret_key" placeholder="(ì„ íƒ) Secret Key ì…ë ¥" id="secret_key_input">
        <br>
        <input type="hidden" name="action" value="decode">
        <button type="submit" id="decodeBtn">Decode</button>
    </form>

    {% if error %}
        <p class="error">{{ error }}</p>
    {% endif %}

    {% if decoded_data %}
        <h3>Header</h3>
        <pre>{{ decoded_data.header | tojson(indent=4) }}</pre>

        <h3>Payload</h3>
        <pre>{{ decoded_data.payload | tojson(indent=4) }}</pre>

        <h3>Signature</h3>
        <pre>{{ decoded_data.signature }}</pre>

        {% if decoded_data.signature_valid is not none %}
            <h3>Signature ê²€ì¦ ê²°ê³¼</h3>
            <p class="{% if decoded_data.signature_valid == True %}valid{% else %}error{% endif %}">
                {% if decoded_data.signature_valid == True %}
                    âœ… ìœ íš¨í•œ ì„œëª…ì…ë‹ˆë‹¤!
                {% elif decoded_data.signature_valid == "Expired" %}
                    â³ ì„œëª…ì´ ë§Œë£Œë˜ì—ˆìŠµë‹ˆë‹¤.
                {% else %}
                    âŒ ì„œëª…ì´ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤!
                {% endif %}
            </p>
        {% endif %}
    {% endif %}
    <hr>

    <h3 style="padding-top: 5%;">âœï¸ JWT Encode</h3>
    <form method="POST">
        <textarea name="header" placeholder='{"alg": "HS256", "typ": "JWT"}'></textarea>
        <br>
        <textarea name="payload" placeholder='{"user": "admin"}'></textarea>
        <br>
        <input type="text" name="secret_key" placeholder="Secret Key ì…ë ¥" required id="secret_key_input">
        <br>
        <input type="number" name="exp_time" placeholder="(ì„ íƒ) Exp ì‹œê°„ (ì´ˆ)" id="secret_key_input">
        <br>
        <input type="hidden" name="action" value="encode">
        <button type="submit" id="encodeBtn">Encode</button>
    </form>

    {% if encoded_token %}
        <h3>ğŸ” ìƒì„±ëœ JWT</h3>
        <pre>{{ encoded_token }}</pre>
    {% endif %}

</body>
</html>
